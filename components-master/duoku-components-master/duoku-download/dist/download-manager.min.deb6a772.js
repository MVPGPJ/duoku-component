!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.DUOKU=e():t.DUOKU=e()}(window,function(){return function(n){var o={};function a(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,a),e.l=!0,e.exports}return a.m=n,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s="./src/downloadManager.js")}({"./lib/bdmgjb-adapter.js":
/*!*******************************!*\
  !*** ./lib/bdmgjb-adapter.js ***!
  \*******************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BdmgjbAdapter=function(t){return{DM:t,stateCenter:{},appCallbackRegister:function(t){var e=t.packageName;this.stateCenter[e]={state:this.DM.STATE.NOT_DOWNLOAD,appInfo:t}},startDownload:function(t){console.log("startDownload"),window.BaiDuMobileGameJsBridge.downloadGame(t.package,t.sname,t.packageid,t.size,t.download_inner,t.icon,t.versionname),window.BaiDuMobileGameJsBridge.showToast("开始下载"),console.log(this.stateCenter[t.package]),this.stateCenter[t.package].state=this.DM.STATE.DOWNLOADING,this.stateCenter[t.package].appInfo.stateChange(t.packageid,2)},pauseDownload:function(t){window.BaiDuMobileGameJsBridge.enterDownLoadManager()},cancelDownload:function(t){},installApp:function(t){},launchApp:function(t){window.BaiDuMobileGameJsBridge.startApp(t.package)},getAppInfo:function(t,e){},getAppState:function(t,e){return window.BaiDuMobileGameJsBridge.isInstall(t)?this.DM.STATE.INSTALLED:this.stateCenter[t]?this.stateCenter[t].state:null},onStateChange:function(t,e){},onProgressChange:function(t,e){}}}},"./lib/bdsjzs-adapter.js":
/*!*******************************!*\
  !*** ./lib/bdsjzs-adapter.js ***!
  \*******************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BdsjzsAdapter=function(t){return{DM:t,STATE:{UNKNOWN:-1,NOT_DOWNLOAD:0,WAIT_DOWNLOAD:1,DOWNLOADING:2,FINISH_DOWNLOAD:3,CAN_UPDATE:4,ALREADY_DOWNLOAD_AND_CAN_UPDATE:5,INSTALLED:6,INSTALLING:7,PAUSE:8,PACKAGING:9,PACKAGE_FAILED:10,NEED_RETRY:11,DELETE:12,UNINSTALL:13,WIFI_PREDOWNLOAD:14},appCallbackRegister:function(t){window.AS.app.appCallbackRegister(t)},startDownload:function(t){console.log("startDownload");var e=t;e.download_inner=t.download_inner_sz,window.AS.app.downloadApp(e)},pauseAppDownload:function(t){window.AS.app.pauseAppDownload(t)},cancelDownload:function(t){window.AS.app.cancelDownload(t)},installApp:function(t){window.AS.app.installApp(t)},launchApp:function(t){window.AS.app.launchApp(t.package)},getAppInfo:function(t,e){return window.AS.app.getAppInfo(t,e)},getAppState:function(t,e){var n=window.AS.app.getAppState(t,e);return n==this.STATE.NOT_DOWNLOAD?this.DM.STATE.NOT_DOWNLOAD:n==this.STATE.DOWNLOADING?this.DM.STATE.DOWNLOADING:n==this.STATE.WAIT_DOWNLOAD?this.DM.STATE.WAIT_DOWNLOAD:n==this.STATE.FINISH_DOWNLOAD?this.DM.STATE.FINISH_DOWNLOAD:n==this.STATE.INSTALLING?this.DM.STATE.INSTALLING:n==this.STATE.INSTALLED?this.DM.STATE.INSTALLED:n==this.STATE.PAUSE?this.DM.STATE.PAUSE:n==this.STATE.WIFI_PREDOWNLOAD?this.DM.STATE.WIFI_PREDOWNLOAD:n},onStateChange:function(t,e){console.log(t+" key === state ===  "+e),1==e?this.DM.emit("wait_download",{key:t}):2==e?this.DM.emit("downloading",{key:t,percent:this.DM.getCache(t+"_percent")||0}):3==e?this.DM.emit("downloaded",{key:t}):6==e?this.DM.emit("installed",{key:t}):7==e?this.DM.emit("installing",{key:t}):8==e?this.DM.emit("pause",{key:t,percent:this.DM.getCache(t+"_percent")||0}):14==e&&this.DM.emit("wifi_predownload",{key:t}),this.DM.setCache(t+"_state",e)},onProgressChange:function(t,e){console.log("percent === "+e),this.DM.emit("progressChange",{key:t,percent:e}),this.DM.setCache(t+"_percent",e),99==e&&(this.DM.emit("progressChange",{key:t,percent:100}),this.DM.setCache(t+"_percent",100))}}}},"./src/downloadManager.js":
/*!********************************!*\
  !*** ./src/downloadManager.js ***!
  \********************************/
/*! no static exports found */function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DownloadManager=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=n(/*! ../lib/bdmgjb-adapter */"./lib/bdmgjb-adapter.js"),p=n(/*! ../lib/bdsjzs-adapter */"./lib/bdsjzs-adapter.js");function o(t){var e=this;this.showWXMast=function(){},t.showWXMast&&(this.showWXMast=t.showWXMast),this.currentEnv=null,this.currentAdapter=null,this.STATE={UNKNOWN:"UNKNOWN",NOT_DOWNLOAD:"NOT_DOWNLOAD",DOWNLOADING:"DOWNLOADING",WAIT_DOWNLOAD:"WAIT_DOWNLOAD",FINISH_DOWNLOAD:"FINISH_DOWNLOAD",INSTALLING:"INSTALLING",INSTALLED:"INSTALLED",PAUSE:"PAUSE",WIFI_PREDOWNLOAD:"WIFI_PREDOWNLOAD"};var n,o,a,r;this._hookCenter={},this.on=function(t,e){void 0===this._hookCenter[t]&&(this._hookCenter[t]=[]),this._hookCenter[t].push(e)},this.emit=function(t,e){if(void 0!==this._hookCenter[t])for(var n=this._hookCenter[t],o=0;o<n.length;o++)n[o](e)},this.CACHE_KEY="BAIDU_MAGEM_DOWNLOAD_MANAGER_BY_KANGBIN",this.setCache=function(t,e){if(localStorage){var n=localStorage[this.CACHE_KEY];(n=void 0===n?{}:JSON.parse(n))[t]=e,localStorage[this.CACHE_KEY]=JSON.stringify(n)}},this.getCache=function(t){if(localStorage){var e=localStorage[this.CACHE_KEY];if(void 0!==e)return(e=JSON.parse(e))[t]}},r=e,"object"==("undefined"==typeof appclient?"undefined":i(appclient))?(console.log("加载手助SDK"),n="//ycimg.m.duoku.com/cimages/img/promo/downsdk/bdsjzs/sdk-1.2.1.min.js",o=function(){if(!window.AS)throw new Error("请先加载百度手机助手SDK");window.AS.ready(function(){r.currentEnv="bdsjzs",r.currentAdapter=new p.BdsjzsAdapter(r),r.emit("ready")})},(a=document.createElement("script")).setAttribute("type","text/javascript"),a.setAttribute("src",n),document.getElementsByTagName("head")[0].appendChild(a),-1<navigator.userAgent.indexOf("MSIE")?a.onreadystatechange=function(){!a||"loaded"!=a.readyState&&"complete"!=a.readyState||(a.onreadystatechange=null,o())}:a.onload=function(){a.onload=null,o()}):("object"==("undefined"==typeof BaiDuMobileGameJsBridge?"undefined":i(BaiDuMobileGameJsBridge))?(e.currentEnv="bdmgjb",e.currentAdapter=new s.BdmgjbAdapter(e)):/iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase())?e.currentAdapter={startDownload:function(t){location.href=t.download_ios}}:/micromessenger/.test(navigator.userAgent.toLowerCase())?e.currentAdapter={startDownload:function(){r.showWXMast()}}:e.currentAdapter={startDownload:function(t){location.href=t.download_android}},setTimeout(function(){e.emit("ready")},100)),e.currentAdapter.getAppState||(e.currentAdapter.getAppState=function(){return""}),e.currentAdapter.appCallbackRegister||(e.currentAdapter.appCallbackRegister=function(){})}o.prototype.test=function(){console.log(this.currentAdapter)},o.prototype.ready=function(t){this.on("ready",t)},o.prototype.appCallbackRegister=function(t){this.currentAdapter.appCallbackRegister(t)},o.prototype.downloadApp=function(t,e){console.log("downloadApp"),this.currentAdapter.startDownload(t,e)},o.prototype.pauseAppDownload=function(t){this.currentAdapter.pauseAppDownload(t)},o.prototype.cancelDownload=function(t){this.currentAdapter.cancelDownload(t)},o.prototype.installApp=function(t){this.currentAdapter.installApp(t)},o.prototype.launchApp=function(t){this.currentAdapter.launchApp(t)},o.prototype.getAppInfo=function(t,e){return this.currentAdapter.getAppInfo(t,e)},o.prototype.getAppState=function(t,e){return console.log("getAppState"),this.currentAdapter.getAppState(t,e)},e.DownloadManager=o}})});